/*! sdk-js - v1.7.10 - 2015-05-25
* Copyright (c) 2015 Schibsted Payment AS; */
"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a){"undefined"!=typeof module&&module.exports?module.exports=a():window.VGS=window.VGS||a()}(function(){var a={version:"1.7.10",client_id:!1,redirect_uri:"undefined"!=typeof window?window.location.toString():"",_session:null,_sessionInitiated:!1,_userStatus:"unknown",_logging:!1,_prod:!0,_varnish_expiration:!1,_refresh_timeout:9e5,_timeout:5e3,_cache:!0,_cache_notloggedin:!1,_cacheLastReset:(new Date).getTime(),_track_throttle:1,_track_anon_opt_out:!1,_track_opt_out:!1,_track_custom_data:null,callbacks:[],cachedResponses:[],guid:function(){return"f"+(Math.random()*(1<<30)).toString(16).replace(".","")},copy:function(a,b,c,d){for(var e in b)(c||"undefined"==typeof a[e])&&(a[e]=d?d(b[e]):b[e]);return a},init:function(b){var c=!0;if(b=a.copy(b||{},{cache:a._cache,cache_notloggedin:a._cache_notloggedin,prod:a._prod,varnish_expiration:a._varnish_expiration,refresh_timeout:a._refresh_timeout,logging:a._logging,timeout:a._timeout,track_throttle:a._track_throttle,track_custom_data:a._track_custom_data,cookie:!0,status:!1,https:!0}),a._logging=b.logging,(!b.logging&&window.location.toString().indexOf("vgs_debug=1")<0||!window.console)&&(a._logging=!1),b.refresh_timeout>=6e4&&(a._refresh_timeout=b.refresh_timeout),a.Cookie.enabled=b.cookie,a._prod=b.prod,a._varnish_expiration=b.varnish_expiration,a._cache=b.cache,a._cache_notloggedin=b.cache_notloggedin,a.Ajax.timeoutPeriod=b.timeout,a._track_throttle=b.track_throttle,a._track_anon_opt_out=b.track_anon_opt_out,a._track_custom_data=b.track_custom_data,a.log('Default connection timeout set to ("'+a.Ajax.timeoutPeriod+'")',"log"),"undefined"==typeof b.client_id&&(a.log("VGS.init: client_id is missing!","error"),c=!1),"undefined"==typeof b.server&&(a.log("VGS.init: server is missing!","error"),c=!1),c){a.client_id=b.client_id,a.Ajax.serverUrl=(b.https?"https":"http")+"://"+b.server+"/",a._prod?(a.Ajax.sessionUrl=(b.https?"https":"http")+"://session."+b.server+"/rpc/hasSession.js",a.Cookie.name="vgs_js_"+a.client_id):(a.Ajax.sessionUrl=(b.https?"https":"http")+"://"+b.server+"/ajax/hasSession.js",a.Cookie.name="vgs_js_test_"+a.client_id),a.log('VGS.init("'+a.client_id+", "+a.Ajax.serverUrl+'")',"log");var d=null,e=null;if(a.Cookie.enabled&&(e=a.Cookie.get()),null!=b.session?(a.log("VGS.init: Session object provided! Expires in "+b.session.expiresIn+" seconds","log"),d=b.session):null!=e?(a.log("VGS.init: Cookie set! Expires in "+e.expiresIn+" seconds","log"),d=e,a.Auth._loadState="loaded"):a.log("VGS.init: No session set! Status unknown.","log"),"object"==typeof d&&null!=d){var f=parseInt(a.Ajax.now(),10),g=parseInt(1e3*d.expiresIn,10);if("undefined"!=typeof d.clientTime){var h=parseInt((d.clientTime+g-f)/1e3,10);d.expiresIn="number"==typeof h&&h>0?h:d.expiresIn,a.log("VGS.init: Session expiration updated to "+d.expiresIn+" seconds","log")}a.Auth.setSession(d,"undefined"!=typeof d.userStatus?d.userStatus:"unknown"),b.status===!0&&a.getLoginStatus()}else(b.status||null===d)&&a.getLoginStatus()}},processing:function(b){a.log('VGS.processing("'+b+'")',"log")},log:function(b,c){a._logging&&("error"===c?a.Event&&("string"==typeof b&&(b={type:"default",description:b,code:400}),a.Event.fire("VGS.error",b)):window.console&&window.console.log(b)),a.Event&&a.Event.fire("VGS.log",b)},Ajax:{connectionId:-1,connections:[],interval:null,intervalPeriod:300,pollingDebugCount:0,pollingDebugFirst:!0,pollingDebugThrottle:100,requestQueue:[],scriptObject:null,serverUrl:"",sessionUrl:"",timeoutPeriod:5e3,version:"1.0",getFragmentFromUrl:function(b){b=b||window.location.href,a.log('VGS.Ajax.getFragmentFromUrl("'+b+'")',"log");var c=b.replace(/^[^#]*#?(.*)$/,"$1");return a.log("-- complete fragment: "+c,"log"),c},buildConnectionUrl:function(b){a.log('VGS.Ajax.buildConnectionUrl("'+b+'")',"log"),a.Ajax.connectionId=a.Ajax.connections.length;var c=("http"===b.substr(0,4)?b:a.Ajax.serverUrl+b)+"&connectionId="+a.Ajax.connectionId+"&client_id="+a.client_id+"&redirect_uri="+encodeURIComponent(a.redirect_uri);a.log("-- built url: ["+c+"]","log"),a.Ajax.requestQueue[a.Ajax.requestQueue.length]=new a.Ajax.requestQueueNode(c)},buildUrl:function(b,c){var d=[];for(var e in c)c[e]&&d.push(e+"="+c[e]);var f=a.Ajax.serverUrl+b+"?"+d.join("&");return a.log("-- built url: ["+f+"]","log"),f},createScriptObject:function(b){a.log('VGS.Ajax.createScriptObject("'+b+'")',"log"),a.Ajax.scriptObject=document.createElement("SCRIPT"),a.Ajax.scriptObject.src=b,a.Ajax.scriptObject.type="text/javascript",a.Ajax.scriptObject.onerror=a.Ajax.loadingError;var c=document.getElementsByTagName("HEAD")[0];c.appendChild(a.Ajax.scriptObject)},failure:function(b){a.log('VGS.Ajax.failure("'+b+'")',"log"),a.Event&&a.Event.fire("VGS.error",{type:"communication",code:503,description:b})},flushQueue:function(){a.log("VGS.Ajax.flushQueue()","log"),a.Ajax.requestQueue.length=0},makeRequest:function(){if(a.log("VGS.Ajax.makeRequest()","log"),a.Ajax.requestQueue.length>0){a.processing("on");var b=a.Ajax.requestQueue[0].connectionUrl;parent.triggerResponse=null,a.Ajax.createScriptObject(b),a.Ajax.serverTimeoutTime=a.Ajax.now()+a.Ajax.timeoutPeriod}},now:function(){return a.log("VGS.Ajax.now()","log"),(new Date).getTime()},poll:function(){a.log("VGS.Ajax.poll()","log"),a.Ajax.pollingDebugCount===a.Ajax.pollingDebugThrottle?(a.log("-- poll ["+a.Ajax.now()+"] (x"+a.Ajax.pollingDebugCount+")","log"),a.Ajax.pollingDebugCount=0):a.Ajax.pollingDebugFirst&&(a.log("-- poll ["+a.Ajax.now()+"]","log"),a.Ajax.pollingDebugFirst=!1,a.Ajax.pollingDebugCount=0),a.Ajax.pollingDebugCount++,a.Ajax.serverTimeoutTime?a.Ajax.serverTimeoutTime<=a.Ajax.now()?(a.Ajax.stopPolling(),a.Ajax.failure("Server Timed Out")):null!=parent.triggerResponse&&parent.triggerResponse():a.Ajax.requestQueue.length>0?a.Ajax.requestQueue.length>10?(a.Ajax.failure("Queue size too big: "+a.Ajax.requestQueue.length+" requests! In order to avoid abuse and overload of the platform we allow max 10 requests in the queue."),a.Ajax.stopPolling()):a.Ajax.makeRequest():a.Ajax.stopPolling()},removeScriptObject:function(){a.log("VGS.Ajax.removeScriptObject()","log"),a.Ajax.scriptObject.parentNode.removeChild(a.Ajax.scriptObject),a.Ajax.scriptObject=null},requestQueueNode:function(b){a.log('VGS.Ajax.requestQueueNode("'+b+'")',"log"),this.connectionUrl=b,this.requestSent=!1},responseReceived:function(){a.log("VGS.Ajax.responseReceived()","log"),a.processing("off"),a.Ajax.requestQueue.shift(),a.Ajax.serverTimeoutTime=null,a.Ajax.removeScriptObject()},send:function(b){a.log('VGS.Ajax.send("'+b+'")',"log"),a.Ajax.buildConnectionUrl(b),a.Ajax.startPolling()},startPolling:function(){a.log("VGS.Ajax.startPolling()","log"),null==a.Ajax.interval&&(a.log("polling (re)started"),a.Ajax.connections[a.Ajax.connectionId]=null,a.Ajax.poll(),a.Ajax.interval=window.setInterval(function(){a.Ajax.connections[a.Ajax.connectionId]=null,a.Ajax.poll()},a.Ajax.intervalPeriod))},stopPolling:function(){a.log("VGS.Ajax.stopPolling()","log"),a.Ajax.serverTimeoutTime=null,a.Ajax.flushQueue(),a.Ajax.interval&&window.clearInterval(a.Ajax.interval),a.Ajax.interval=null},success:function(b){b.success?a.log("SUCCESS: "+b.success,"log"):b.error&&(a.log("ERROR: "+b.error,"log"),a.Event&&a.Event.fire("VGS.error",{type:"response",code:400,description:b.error}))},loadingError:function(){a.log("VGS.Ajax.loadingError()","log"),a.Ajax.stopPolling(),a.Ajax.failure("Server Timed Out")}},Cookie:{enabled:!0,name:"",domain:"",decode:function(a){return JSON.parse(window.unescape(a))},encode:function(a){return window.escape(JSON.stringify(a))},set:function(b){return a.log("VGS.Cookie.set()","log"),b?(a.Cookie.setRaw(a.Cookie.encode(b),b.expiresIn,b.baseDomain,a.Cookie.name),b.sp_id&&(a._varnish_expiration||(a._varnish_expiration=b.expiresIn),a.Cookie.setRaw(b.sp_id,a._varnish_expiration,b.baseDomain,"SP_ID"))):a.Cookie.clear(),b},get:function(){a.log("VGS.Cookie.get() -- "+a.Cookie.name,"log");var b,c,d,e=null;d=a.Cookie.name+"=",e=document.cookie.split(";");for(var f=0;f<e.length;f++){for(var g=e[f];" "===g.charAt(0);)g=g.substring(1,g.length);0===g.indexOf(d)&&(b=g.substring(d.length,g.length))}return b&&(c=a.Cookie.decode(b),c.expiresIn=parseInt(c.expiresIn,10),c.clientTime=parseInt(c.clientTime,10),a.Cookie.domain=c.baseDomain),c},setRaw:function(b,c,d,e){a.log("VGS.Cookie.setRaw(val, "+c+", "+d+", "+e+")","log");var f="";if("undefined"==typeof e&&(e=a.Cookie.name),a.Cookie.domain=d,"undefined"!=typeof c){var g=new Date;g.setTime(g.getTime()+1e3*c),f="; expires="+g.toGMTString(),document.cookie=e+"="+b+f+"; path=/"+(d?"; domain=."+d:"")}else a.log("VGS.Cookie.setRaw() expiration is invalid:"+c+", no cookie set)","log")},clear:function(){a.log("VGS.Cookie.clear() "+a.Cookie.name,"log"),a.Cookie.setRaw("",0,a.Cookie.domain),a.log("VGS.Cookie.clear() SP_ID","log"),a.Cookie.setRaw("",0,a.Cookie.domain,"SP_ID")}},Auth:{valid:!1,logout:function(b){a.log("VGS.Auth.logout","log"),a.Auth.setSession(null,"unknown");var c="";"function"==typeof b&&(c=a.guid(),a.callbacks[c]=b),a.Ajax.send("ajax/logout.js?callback="+c)},validate:function(b){a.log("VGS.Auth.validate","log"),a.Auth.valid=!1,a._track_opt_out=b.tracking?!1:!0,a.log("VGS._track_opt_out: "+a._track_opt_out,"log"),a.log(b,"log"),b.result?("undefined"!=typeof b.visitor&&a.Event.fire("auth.visitor",b.visitor),a.Auth.valid=b.result,a.log("SUCCESS: "+a.Auth.valid,"log"),a.Auth.valid&&"undefined"!=typeof b.userId?(a.log("-- valid session, allow login","log"),a.Auth.setSession(b,"undefined"!=typeof b.userStatus?b.userStatus:"unknown")):(a.log("-- invalid session, do not allow login","log"),a.Auth.setSession(null,"unknown"))):b.error&&b.response?("undefined"!=typeof b.response.visitor&&a.Event.fire("auth.visitor",b.response.visitor),"LoginException"===b.error.type?(a.log(b.error,"log"),a.Event.fire("VGS.loginException",b)):(a.log(b.error,"error"),a._cache_notloggedin?(b.response.expiresIn=parseInt(a._refresh_timeout,10)/1e3,a.Auth.setSession(b.response,"unknown")):a.Auth.setSession(null,"unknown"))):(a.log(b,"error"),a.Auth.setSession(null,"unknown"))},setSession:function(b,c){a.log("VGS.Auth.setSession ("+typeof b+" , "+c+")","log");var d=!1,e=!1;"object"==typeof b&&null!==b&&b.hasOwnProperty("userId")&&(d=!0),"object"==typeof a._session&&null!==a._session&&a._session.hasOwnProperty("userId")&&(e=!0);var f=!e&&d,g=e&&!d,h=!e&&!d,i=e&&d&&a._session.id!==b.id,j=f||g||e&&d&&a._session.sig!==b.sig||h,k=c!==a._userStatus,l={session:b,status:c};return"object"==typeof b&&null!==b&&(b.clientTime=parseInt(a.Ajax.now(),10)),a._session=b,a._userStatus=c,j&&a.Cookie.enabled&&a.Cookie.set(b),h&&a.Event.fire("auth.notLoggedin",l),k&&a.Event.fire("auth.statusChange",l),(g||i)&&a.Event.fire("auth.logout",l),(f||i)&&a.Event.fire("auth.login",l),j&&a.Event.fire("auth.sessionChange",l),i&&a.Event.fire("auth.userChange",l),d&&!a._sessionInitiated&&(a._sessionInitiated=!0,a.Event.fire("auth.sessionInit",l)),a.Auth._refreshTimer&&(window.clearTimeout(a.Auth._refreshTimer),delete a.Auth._refreshTimer),a.Auth._loadState&&b&&b.expiresIn&&(a.log("--  refresh every "+a._refresh_timeout+" milliseconds","log"),a.Auth._refreshTimer=window.setTimeout(function(){a.getLoginStatus(null,!0)},a._refresh_timeout)),l}},getSession:function(){return a.log("VGS.getSession","log"),a._session},getLoginStatus:function(b,c){if(a.log("VGS.getLoginStatus("+b+","+c+")","log"),!a.client_id)return void a.log("ERROR: VGS.getLoginStatus() called before calling VGS.init().","error");c=c===!0;var d;if(b){if(!c&&"loaded"===a.Auth._loadState)return a.log("VGS.getLoginStatus(): status has already been loaded! "+a.Auth._loadState,"log"),void b({status:a._userStatus,session:a._session});a.log("VGS.Event.subscribe(VGS.loginStatus) "+a.Auth._loadState,"log"),"function"==typeof b?(d=a.guid(),a.callbacks[d]=b,a.Event.subscribe("VGS.loginStatus",a.callbacks[d])):a.Event.subscribe("VGS.loginStatus",b)}if(!c&&"loading"===a.Auth._loadState)return void a.log("VGS.getLoginStatus() already loading, returning..."+a.Auth._loadState,"log");a.Auth._loadState="loading";var e=function(b){a.log("VGS.callbacks -- "+a.Auth._loadState,"log"),a.Auth._loadState="loaded",a.Auth.validate(b),a.Event.fire("VGS.loginStatus",b),a.Event.clear("VGS.loginStatus")};d=a.guid(),a.callbacks[d]=e,a.Event.subscribe("VGS.loginException",function(){d=a.guid(),a.callbacks[d]=function(b){a.log("VGS.callbacks -- "+a.Auth._loadState,"log"),a.Auth._loadState="loaded",a.Auth.validate(b),a.Event.fire("VGS.loginStatus",b),a.Event.clear("VGS.loginStatus")},a.Event.clear("VGS.loginException"),a.Ajax.send("ajax/hasSession.js?callback="+d+"&autologin=1")}),a.Ajax.send(a.Ajax.sessionUrl+"?callback="+d)},hasProduct:function(b,c,d){if(a.log("VGS.hasProduct("+b+")","log"),!a.client_id)return void a.log("ERROR: VGS.hasProduct() called before calling VGS.init().","error");d=d===!0;var e=(new Date).getTime();if(a._cacheLastReset+a._refresh_timeout<e&&(a.log("VGS.hasProduct("+b+"): Cache timedout, forcing request.","log"),d=!0),!d&&"object"==typeof a.cachedResponses["prd_"+b]&&null!==a.cachedResponses["prd_"+b])return a.log("VGS.hasProduct("+b+"): Product cached.","log"),void c(a.cachedResponses["prd_"+b]);a.log("VGS.hasProduct("+b+"): Product NOT cached.","log");var f=function(d){a.cachedResponses["prd_"+b]=d,a._cacheLastReset=(new Date).getTime(),c(d)},g=a.guid();a.callbacks[g]=f,a.Ajax.send("ajax/hasproduct.js?product_id="+b+"&callback="+g)},hasSubscription:function(b,c,d){if(a.log("VGS.hasSubscription("+b+")","log"),!a.client_id)return void a.log("ERROR: VGS.hasSubscription() called before calling VGS.init().","error");d=d===!0;var e=(new Date).getTime();if(a._cacheLastReset+a._refresh_timeout<e&&(a.log("VGS.hasSubscription("+b+"): Cache timedout, forcing request.","log"),d=!0),!d&&"object"==typeof a.cachedResponses["sub_"+b]&&null!==a.cachedResponses["sub_"+b])return a.log("VGS.hasSubscription("+b+"): Product cached.","log"),void c(a.cachedResponses["sub_"+b]);a.log("VGS.hasSubscription("+b+"): Product NOT cached.","log");var f=function(d){a.cachedResponses["sub_"+b]=d,a._cacheLastReset=(new Date).getTime(),c(d)},g=a.guid();a.callbacks[g]=f,a.Ajax.send("ajax/hassubscription.js?product_id="+b+"&callback="+g)},setTraits:function(b,c){if(a.log("VGS.setTraits("+b+")","log"),!a.client_id)return void a.log("ERROR: VGS.setTraits() called before calling VGS.init().","error");var d=function(a){c(a)},e=a.guid();a.callbacks[e]=d,a.Ajax.send("ajax/traits.js?t="+b+"&callback="+e)},getLoginURI:function(b,c){var d={response_type:"code",client_id:c||a.client_id,redirect_uri:encodeURIComponent(b||window.location.toString())};return a.Ajax.buildUrl("flow/login",d)},getSignupURI:function(b,c){var d={response_type:"code",client_id:c||a.client_id,redirect_uri:encodeURIComponent(b||window.location.toString())};return a.Ajax.buildUrl("flow/signup",d)},getLogoutURI:function(b,c){var d={client_id:c||a.client_id,redirect_uri:encodeURIComponent(b||window.location.toString())};return a.Ajax.buildUrl("logout",d)},getAccountURI:function(b,c){var d={response_type:"code",client_id:c||a.client_id,redirect_uri:encodeURIComponent(b||window.location.toString())};return a.Ajax.buildUrl("account/summary",d)},getPurchaseHistoryURI:function(b,c){var d={response_type:"code",client_id:c||a.client_id,redirect_uri:encodeURIComponent(b||window.location.toString())};return a.Ajax.buildUrl("account/purchasehistory",d)},getSubscriptionsURI:function(b,c){var d={response_type:"code",client_id:c||a.client_id,redirect_uri:encodeURIComponent(b||window.location.toString())};return a.Ajax.buildUrl("account/subscriptions",d)},getProductsURI:function(b,c){var d={response_type:"code",client_id:c||a.client_id,redirect_uri:encodeURIComponent(b||window.location.toString())};return a.Ajax.buildUrl("account/products",d)},getRedeemVoucherURI:function(b,c,d){var e={response_type:"code",client_id:d||a.client_id,redirect_uri:encodeURIComponent(c||window.location.toString()),voucher_code:b||null};return a.Ajax.buildUrl("account/redeem",e)},getPurchaseProductURI:function(b,c,d){var e={response_type:"code",client_id:d||a.client_id,redirect_uri:encodeURIComponent(c||window.location.toString()),product_id:b||null};return a.Ajax.buildUrl("flow/checkout",e)},getPurchaseCampaignURI:function(b,c,d,e,f){var g={response_type:"code",client_id:f||a.client_id,redirect_uri:encodeURIComponent(e||window.location.toString()),campaign_id:b||null,product_id:c||null,voucher_code:d||null};return a.Ajax.buildUrl("flow/checkout",g)},getFlowUrl:function(b,c){c=a.copy(c,{client_id:a.client_id,redirect_uri:encodeURIComponent(window.location.toString()),response_type:"code"});var d="flow/"+b;return a.Ajax.buildUrl(d,c)},Event:{subscribers:function(){return this._subscribersMap||(this._subscribersMap={}),this._subscribersMap},subscribe:function(a,b){var c=this.subscribers();c[a]?c[a].push(b):c[a]=[b]},unsubscribe:function(b,c){var d=this.subscribers()[b];a.Array.forEach(d,function(a,b){a===c&&(d[b]=null)})},monitor:function(a,b){if(!b()){var c=this,d=function(){b.apply(b,arguments)&&c.unsubscribe(a,d)};this.subscribe(a,d)}},clear:function(a){delete this.subscribers()[a]},fire:function(){var b=Array.prototype.slice.call(arguments),c=b.shift();a.Array.forEach(this.subscribers()[c],function(d){d&&(a.log('VGS.Event.fire("'+c+'")',"log"),d.apply(this,b))})}},Array:{forEach:function(a,b,c){if(a)if("[object Array]"!==Object.prototype.toString.apply(a)&&(a instanceof Function||"number"!=typeof a.length))for(var d in a)(c||a.hasOwnProperty(d))&&b(a[d],d,a);else if(a.forEach)a.forEach(b);else for(var e=0,f=a.length;f>e;e++)b(a[e],e,a)}}};return"undefined"!=typeof window&&window.setTimeout(function(){"function"!=typeof window.vgsAsyncInit||window.vgsAsyncInit.hasRun||(window.vgsAsyncInit.hasRun=!0,window.vgsAsyncInit())},0),a});